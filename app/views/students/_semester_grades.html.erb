<h2>Oceny – <%= semester&.name || "Wybierz semestr" %></h2>

<% if grades.any? %>
  <table class="grades-table">
    <tr>
      <th>Przedmiot</th>
      <th>ECTS</th>
      <th>Ocena</th>
      <th></th>
    </tr>

    <% grades.each do |g| %>
      <tr id="grade_<%= g.id %>">
        <td><%= g.course.name %></td>
        <td><%= g.course.ects %></td>
        <td><%= g.grade %></td>
        <td>
          <%= button_to "✖",
                        grade_path(g),
                        method: :delete,
                        form: { data: { turbo_frame: "grades" } },
                        class: "btn-danger" %>
        </td>
      </tr>
    <% end %>
  </table>
<% else %>
  <p>Brak ocen w tym semestrze</p>
<% end %>

<hr>

<% if semester.present? %>
  <h3>➕ Dodaj ocenę</h3>

  <%= form_with model: Grade.new,
                url: grades_path,
                data: { turbo_frame: "grades" },
                html: { class: "grade-form" } do |f| %>

    <%= f.hidden_field :student_id, value: student.id %>
    <%= f.hidden_field :semester_id, value: semester.id %>

    <div>
      <%= f.collection_select :course_id, Course.all, :id, :name, prompt: "Wybierz przedmiot" %>
    </div>

    <div>
      <%= f.number_field :grade, step: 0.5, min: 2.0, max: 5.0 %>
    </div>

    <%= f.submit "Dodaj", class: "btn" %>

  <% end %>
<% else %>
  <p>Wybierz semestr aby dodać ocenę</p>
<% end %>
