<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <style>
      body {
          font-family: Arial, sans-serif;
          padding: 30px;
          font-size: 14px;
      }

      h1 {
          text-align: center;
          margin-bottom: 10px;
      }

      h2 {
          margin-top: 30px;
          border-bottom: 2px solid #333;
          padding-bottom: 5px;
      }

      .info {
          margin-bottom: 20px;
      }

      .info strong {
          display: inline-block;
          width: 120px;
      }

      table {
          width: 100%;
          border-collapse: collapse;
          margin-top: 15px;
      }

      th {
          background: #222;
          color: white;
          padding: 8px;
          text-align: left;
      }

      td {
          padding: 8px;
          border-bottom: 1px solid #ddd;
      }

      .ok { color: green; font-weight: bold; }
      .bad { color: red; font-weight: bold; }

      .footer {
          margin-top: 40px;
          text-align: center;
          font-size: 12px;
          color: #777;
      }
  </style>
</head>

<body>

<h1>ðŸ“˜ Indeks studenta</h1>

<div class="info">
  <p><strong>ImiÄ™:</strong> <%= @student.first_name %> <%= @student.last_name %></p>
  <p><strong>Album:</strong> <%= @student.album %></p>
  <p><strong>Grupa:</strong> <%= @student.group&.name %></p>
  <p><strong>Åšrednia ogÃ³lna:</strong> <%= @student.average_grade %></p>
</div>

<h2>ðŸ“š Semestry</h2>

<% @student.grades.includes(:semester).map(&:semester).uniq.each do |sem| %>
  <h3><%= sem.name %> (<%= sem.start_date %> â€“ <%= sem.end_date %>)</h3>

  <p>
    Åšrednia: <%= @student.average_for_semester(sem) %><br>
    ECTS: <%= @student.ects_for_semester(sem) %><br>
    Status:
    <% if @student.passed_semester?(sem) %>
      <span class="ok">Zaliczony</span>
    <% else %>
      <span class="bad">Nie zaliczony</span>
    <% end %>
  </p>
<% end %>

<h2>ðŸ§® Oceny</h2>

<table>
  <tr>
    <th>Przedmiot</th>
    <th>ECTS</th>
    <th>Ocena</th>
    <th>Semestr</th>
  </tr>

  <% @grades.each do |g| %>
    <tr>
      <td><%= g.course.name %></td>
      <td><%= g.course.ects %></td>
      <td class="<%= g.grade >= 3 ? 'ok' : 'bad' %>"><%= g.grade %></td>
      <td><%= g.semester.name %></td>
    </tr>
  <% end %>
</table>

<div class="footer">
  Wygenerowano: <%= Time.now.strftime("%d.%m.%Y %H:%M") %> â€“ System dziekanatu
</div>

</body>
</html>
